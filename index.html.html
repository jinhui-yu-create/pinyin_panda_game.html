<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinyin Panda Typing Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0fdf4; /* A light, friendly green */
        }
        .game-container {
            font-family: 'Fredoka One', cursive;
            text-align: center;
        }
        .panda-container {
            position: relative;
            width: 150px;
            height: 150px;
            margin: 0 auto;
        }
        .panda-face {
            width: 150px;
            height: 150px;
            background: white;
            border: 4px solid #333;
            border-radius: 50%;
            position: absolute;
            transition: transform 0.3s ease;
        }
        .ear {
            width: 50px;
            height: 50px;
            background: #333;
            border-radius: 50%;
            position: absolute;
            top: -10px;
        }
        .ear.left { left: -10px; }
        .ear.right { right: -10px; }
        .eye {
            width: 40px;
            height: 50px;
            background: #333;
            border-radius: 50%;
            position: absolute;
            top: 40px;
        }
        .eye.left { left: 25px; }
        .eye.right { right: 25px; }
        .pupil {
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 15px;
            left: 15px;
            transition: transform 0.2s;
        }
        .nose {
            width: 25px;
            height: 18px;
            background: #333;
            border-radius: 50% 50% 40% 40% / 60% 60% 40% 40%;
            position: absolute;
            top: 85px;
            left: 62.5px;
        }
        .mouth {
            width: 30px;
            height: 15px;
            border: 3px solid transparent;
            border-bottom-color: #333;
            border-radius: 0 0 100px 100px / 0 0 50px 50px;
            position: absolute;
            top: 95px;
            left: 60px;
        }
        #character-display-container {
            position: relative;
            cursor: pointer;
        }
        #character-display {
            font-size: 8rem; /* Make the character very large */
            line-height: 1;
            color: #166534; /* Dark green */
            margin-top: 1rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        #character-display:hover {
            transform: scale(1.05);
        }
        #speaker-icon {
            position: absolute;
            top: 50%;
            right: 20%;
            transform: translateY(-50%);
            font-size: 2rem;
            color: #9ca3af;
            opacity: 0;
            transition: opacity 0.3s;
        }
        #character-display-container:hover #speaker-icon {
            opacity: 1;
        }

        .feedback {
            height: 30px;
            font-size: 1.5rem;
            margin-top: 1rem;
            font-weight: bold;
        }
        .correct { color: #22c55e; }
        .incorrect { color: #ef4444; }

        /* Input field animation */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.5s;
        }
        
        /* Progress Bar */
        .progress-bar-container {
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 9999px;
            height: 20px;
            overflow: hidden;
            border: 2px solid #a3a3a3;
        }
        .progress-bar {
            background-color: #4ade80; /* A nice, bright green */
            height: 100%;
            width: 0%;
            transition: width 0.5s ease-in-out;
            border-radius: 9999px;
        }

        /* Score animation */
        @keyframes float-up {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-50px) scale(1.5);
            }
        }
        .score-plus {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2rem;
            color: #f59e0b;
            pointer-events: none;
            animation: float-up 0.8s ease-out forwards;
        }
    </style>
</head>
<body class="bg-green-50 flex items-center justify-center min-h-screen p-4">

    <div class="game-container w-full max-w-2xl mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-lg border-4 border-gray-700">

        <!-- Header with Panda and Score -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-6">
            <div class="flex items-center gap-4">
                <div class="panda-container">
                    <div class="panda-face">
                        <div class="ear left"></div>
                        <div class="ear right"></div>
                        <div class="eye left"><div class="pupil"></div></div>
                        <div class="eye right"><div class="pupil"></div></div>
                        <div class="nose"></div>
                        <div class="mouth"></div>
                    </div>
                </div>
                <h1 class="text-3xl md:text-4xl text-gray-800">Pinyin Panda</h1>
            </div>
            <div class="text-2xl md:text-3xl bg-yellow-300 px-4 py-2 rounded-lg border-2 border-gray-700 shadow-sm mt-4 md:mt-0">
                Score: <span id="score" class="font-bold">0</span>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="mb-6">
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
        </div>

        <!-- Game Area -->
        <div id="game-area">
            <p class="text-xl text-gray-600 mb-2">Click the character to hear it!</p>
            <div id="character-display-container">
                <div id="character-display" class="select-none"></div>
                <div id="speaker-icon">ðŸ”Š</div>
            </div>
            
            <div id="definition-box" class="min-h-[3rem] text-xl bg-green-100 border-2 border-green-300 text-green-800 p-2 rounded-lg my-2 opacity-0 transition-opacity duration-300"></div>

            <input type="text" id="pinyin-input" placeholder="e.g. ni3 hao3" autocomplete="off" class="w-full max-w-md mx-auto mt-2 p-4 text-2xl border-4 border-gray-400 rounded-lg text-center focus:border-green-500 focus:ring-green-500 transition duration-300">
            
            <div id="feedback" class="feedback"></div>

            <div class="flex gap-4 justify-center mt-4">
                <button id="hint-button" class="w-1/2 max-w-sm bg-blue-500 hover:bg-blue-600 text-white font-bold text-xl py-3 px-4 rounded-lg shadow-md transition transform hover:scale-105">ðŸ’¡ Hint</button>
                <button id="check-button" class="w-1/2 max-w-sm bg-green-500 hover:bg-green-600 text-white font-bold text-xl py-3 px-4 rounded-lg shadow-md transition transform hover:scale-105">Check</button>
            </div>
        </div>
        
        <!-- Game Over Screen -->
        <div id="game-over-screen" class="hidden text-center">
            <h2 class="text-5xl text-green-600 mb-4">Great Job!</h2>
            <p class="text-2xl text-gray-700 mb-2">Your final score is:</p>
            <p id="final-score" class="text-6xl font-bold text-yellow-500 mb-6"></p>
            <img src="https://placehold.co/200x200/a7f3d0/14532d?text=ðŸŽ‰" alt="Celebration" class="mx-auto rounded-full mb-6">
            <button id="restart-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold text-2xl py-4 px-8 rounded-lg shadow-md transition transform hover:scale-105">Play Again</button>
        </div>

    </div>

    <script>
        // --- EDIT YOUR VOCABULARY HERE ---
        const vocabulary = [
            { character: 'æœ¬å­', pinyin: 'ben3 zi5', english: 'notebook' },
            { character: 'æ¡Œå­', pinyin: 'zhuo1 zi5', english: 'table, desk' },
            { character: 'ä¹¦åŒ…', pinyin: 'shu1 bao1', english: 'school bag' },
            { character: 'æ¤…å­', pinyin: 'yi3 zi5', english: 'chair' },
            { character: 'è‹¹æžœ', pinyin: 'ping2 guo3', english: 'apple' },
            { character: 'å†°ç®±', pinyin: 'bing1 xiang1', english: 'refrigerator' },
            { character: 'ç”µè„‘', pinyin: 'dian4 nao3', english: 'computer' },
            { character: 'æ˜¥å¤©', pinyin: 'chun1 tian1', english: 'Spring (season)' },
            { character: 'çœ¼ç›', pinyin: 'yan3 jing5', english: 'eye' },
            { character: 'çˆ¸çˆ¸', pinyin: 'ba4 ba5', english: 'dad' },
            { character: 'å¦ˆå¦ˆ', pinyin: 'ma1 ma5', english: 'mom' },
            { character: 'è€å¸ˆ', pinyin: 'lao3 shi1', english: 'teacher' },
            { character: 'åŒ»ç”Ÿ', pinyin: 'yi1 sheng1', english: 'doctor' },
            { character: 'å“¥å“¥', pinyin: 'ge1 ge5', english: 'older brother' },
            { character: 'å­¦ç”Ÿ', pinyin: 'xue2 sheng1', english: 'student' },
            { character: 'è­¦å¯Ÿ', pinyin: 'jing3 cha2', english: 'police officer' },
            { character: 'æˆ¿é—´', pinyin: 'fang2 jian1', english: 'room' },
            { character: 'çŽ©å…·', pinyin: 'wan2 ju4', english: 'toy' },
            { character: 'åŠ¨ç‰©å›­', pinyin: 'dong4 wu4 yuan2', english: 'zoo' },
            { character: 'è€è™Ž', pinyin: 'lao3 hu3', english: 'tiger' },
            { character: 'ç‹®å­', pinyin: 'shi1 zi5', english: 'lion' },
            { character: 'å¤§ç†ŠçŒ«', pinyin: 'da4 xiong2 mao1', english: 'giant panda' },
            { character: 'ç”Ÿæ—¥', pinyin: 'sheng1 ri4', english: 'birthday' },
            { character: 'è›‹ç³•', pinyin: 'dan4 gao1', english: 'cake' },
            { character: 'æ¸¸æ³³', pinyin: 'you2 yong3', english: 'to swim' },
            { character: 'çœ‹ç”µè§†', pinyin: 'kan4 dian4 shi4', english: 'watch TV' },
            { character: 'æ‰“ç”µè¯', pinyin: 'da3 dian4 hua4', english: 'make a phone call' },
            { character: 'é¥­é¦†', pinyin: 'fan4 guan3', english: 'restaurant' },
            { character: 'ç±³é¥­', pinyin: 'mi3 fan4', english: 'cooked rice' },
            { character: 'ä½ å¥½', pinyin: 'ni3 hao3', english: 'hello' },
            { character: 'è°¢è°¢', pinyin: 'xie4 xie5', english: 'thank you' },
            { character: 'å†è§', pinyin: 'zai4 jian4', english: 'goodbye' },
            { character: 'ä¸å®¢æ°”', pinyin: 'bu2 ke4 qi5', english: 'you\'re welcome' },
            { character: 'å¯¹ä¸èµ·', pinyin: 'dui4 bu5 qi3', english: 'I\'m sorry' },
            { character: 'æ²¡å…³ç³»', pinyin: 'mei2 guan1 xi5', english: 'it doesn\'t matter, no problem' }
        ];
        // ------------------------------------

        let currentWordIndex = 0;
        let score = 0;
        let shuffledVocabulary = [];
        let audioContext;

        const characterDisplayContainer = document.getElementById('character-display-container');
        const characterDisplay = document.getElementById('character-display');
        const pinyinInput = document.getElementById('pinyin-input');
        const feedbackEl = document.getElementById('feedback');
        const scoreEl = document.getElementById('score');
        const checkButton = document.getElementById('check-button');
        const hintButton = document.getElementById('hint-button');
        const definitionBox = document.getElementById('definition-box');
        const restartButton = document.getElementById('restart-button');
        const gameArea = document.getElementById('game-area');
        const gameOverScreen = document.getElementById('game-over-screen');
        const finalScoreEl = document.getElementById('final-score');
        const progressBar = document.getElementById('progress-bar');
        const pupilLeft = document.querySelector('.eye.left .pupil');
        const pupilRight = document.querySelector('.eye.right .pupil');
        const pandaFace = document.querySelector('.panda-face');

        // Sound Effects
        function setupAudio() {
             if (!audioContext) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.error("Web Audio API is not supported in this browser");
                }
            }
        }

        function playSound(type) {
            if (!audioContext) return;
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            if (type === 'correct') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + 0.5);
            } else if (type === 'incorrect') {
                oscillator.type = 'square';
                oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.00001, audioContext.currentTime + 0.3);
            }
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Pronunciation
        function speak(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'zh-CN'; // Set language to Chinese
                utterance.rate = 0.8;
                window.speechSynthesis.speak(utterance);
            } else {
                alert("Sorry, your browser doesn't support text-to-speech.");
            }
        }
        
        function startGame() {
            shuffledVocabulary = [...vocabulary].sort(() => Math.random() - 0.5);
            currentWordIndex = 0;
            score = 0;
            updateScore();
            updateProgressBar();
            displayWord();

            gameArea.classList.remove('hidden');
            gameOverScreen.classList.add('hidden');
            pinyinInput.value = '';
            pinyinInput.disabled = false;
            checkButton.disabled = false;
            hintButton.disabled = false;
            feedbackEl.textContent = '';
            pinyinInput.focus();
        }

        function displayWord() {
            if (currentWordIndex < shuffledVocabulary.length) {
                const currentWord = shuffledVocabulary[currentWordIndex];
                characterDisplay.textContent = currentWord.character;
                definitionBox.textContent = `Hint: ${currentWord.english}`;
                definitionBox.style.opacity = '0'; // Hide hint initially

                if (currentWord.character.length > 4) {
                    characterDisplay.style.fontSize = '4rem';
                } else if (currentWord.character.length > 2) {
                    characterDisplay.style.fontSize = '6rem';
                } else {
                    characterDisplay.style.fontSize = '8rem';
                }
            } else {
                endGame();
            }
        }

        function checkAnswer() {
            const userAnswer = pinyinInput.value.trim().toLowerCase();
            const correctAnswer = shuffledVocabulary[currentWordIndex].pinyin.toLowerCase();

            if (userAnswer === correctAnswer) {
                playSound('correct');
                score++;
                feedbackEl.textContent = "Correct! ðŸŽ‰";
                feedbackEl.className = 'feedback correct';
                pinyinInput.classList.remove('shake', 'border-red-500');
                pinyinInput.classList.add('border-green-500');
                pandaFace.style.transform = 'scale(1.1) rotate(5deg)';
                
                // Show score animation
                const plus = document.createElement('div');
                plus.textContent = '+10';
                plus.className = 'score-plus';
                characterDisplayContainer.appendChild(plus);
                setTimeout(() => plus.remove(), 800);

                setTimeout(() => {
                    currentWordIndex++;
                    updateScore();
                    updateProgressBar();
                    displayWord();
                    pinyinInput.value = '';
                    feedbackEl.textContent = '';
                    pinyinInput.classList.remove('border-green-500');
                    pandaFace.style.transform = 'scale(1) rotate(0deg)';
                    pinyinInput.focus();
                }, 1200);

            } else {
                playSound('incorrect');
                feedbackEl.textContent = "Try again! ðŸ™ˆ";
                feedbackEl.className = 'feedback incorrect';
                pinyinInput.classList.add('shake', 'border-red-500');
                pandaFace.style.transform = 'rotate(-5deg)';
                
                setTimeout(() => {
                    pinyinInput.classList.remove('shake');
                    pandaFace.style.transform = 'rotate(0deg)';
                }, 500);
            }
        }
        
        function showHint() {
            definitionBox.style.opacity = '1';
        }

        function updateScore() {
            scoreEl.textContent = score * 10; // Give 10 points per correct answer
        }

        function updateProgressBar() {
            const progress = (currentWordIndex / shuffledVocabulary.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        function endGame() {
            gameArea.classList.add('hidden');
            gameOverScreen.classList.remove('hidden');
            finalScoreEl.textContent = score * 10;
            pinyinInput.disabled = true;
            checkButton.disabled = true;
            hintButton.disabled = true;
        }

        // Event listeners
        document.body.addEventListener('click', setupAudio, { once: true });
        checkButton.addEventListener('click', checkAnswer);
        hintButton.addEventListener('click', showHint);
        pinyinInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') checkAnswer();
        });
        characterDisplayContainer.addEventListener('click', () => {
             if(currentWordIndex < shuffledVocabulary.length) {
                speak(shuffledVocabulary[currentWordIndex].character);
            }
        });
        restartButton.addEventListener('click', startGame);

        document.addEventListener('mousemove', (e) => {
            const { clientX, clientY } = e;
            const rect = pinyinInput.getBoundingClientRect();
            const inputX = rect.left + rect.width / 2;
            const inputY = rect.top + rect.height / 2;
            const deltaX = clientX - inputX;
            const deltaY = clientY - inputY;
            const angle = Math.atan2(deltaY, deltaX);
            const moveX = Math.cos(angle) * 4;
            const moveY = Math.sin(angle) * 2;
            pupilLeft.style.transform = `translate(${moveX}px, ${moveY}px)`;
            pupilRight.style.transform = `translate(${moveX}px, ${moveY}px)`;
        });

        startGame();
    </script>
</body>
</html>

